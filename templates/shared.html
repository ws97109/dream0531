{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-lg-8 offset-lg-2">
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h2 class="card-title mb-0">
                    <i class="bi bi-share"></i> åˆ†äº«çš„å¤¢å¢ƒåˆ†æçµæœ
                </h2>
                <small class="text-white-50">åˆ†äº«æ™‚é–“: {{ data.created_at }}</small>
            </div>
            <div class="card-body">
                <p class="text-muted">ä»¥ä¸‹æ˜¯ä¸€ä½ç”¨æˆ¶åˆ†äº«çš„å¤¢å¢ƒåˆ†æçµæœï¼š</p>
            </div>
        </div>
        
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0">å¤¢å¢ƒæ•…äº‹</h5>
            </div>
            <div class="card-body">
                <p>{{ data.finalStory }}</p>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">è¦–è¦ºåŒ–å¤¢å¢ƒ</h5>
                    </div>
                    <div class="card-body text-center">
                        {% if data.imagePath %}
                            <img src="/static/{{ data.imagePath }}" class="img-fluid rounded" alt="å¤¢å¢ƒè¦–è¦ºåŒ–åœ–åƒ" style="max-height: 400px;">
                        {% else %}
                            <img src="/static/images/default_dream.png" class="img-fluid rounded" alt="é è¨­å¤¢å¢ƒåœ–åƒ" style="max-height: 400px;">
                        {% endif %}
                        <div class="text-muted small mt-2">ç”± Stable Diffusion ç”Ÿæˆ</div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card mb-4">
                    <div class="card-header bg-danger text-white">
                        <h5 class="mb-0">å¤¢å¢ƒå¿ƒç†åˆ†æ</h5>
                    </div>
                    <div class="card-body">
                        <p>{{ data.psychologyAnalysis }}</p>
                    </div>
                </div>
            </div>
        </div>
        
        {% if data.videoPath %}
        <div class="col-md-12">
            <div class="card mb-4">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">ğŸ¬ å¤¢å¢ƒå½±ç‰‡</h5>
                </div>
                <div class="card-body text-center">
                    <video class="img-fluid rounded" controls style="max-width: 100%; max-height: 400px;">
                        <source src="/static/{{ data.videoPath }}" type="video/mp4">
                        æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´å½±ç‰‡æ’­æ”¾
                    </video>
                    <div class="text-muted small mt-2">ç”± Stable Video Diffusion ç”Ÿæˆ</div>
                </div>
            </div>
        </div>
        {% endif %}
        
        <div class="text-center mb-4">
            <a href="/" class="btn btn-primary">
                <i class="bi bi-arrow-left-circle"></i> è¿”å›é¦–é 
            </a>
            <button class="btn btn-success ms-2" onclick="shareCurrentPage()">
                <i class="bi bi-share"></i> å†æ¬¡åˆ†äº«
            </button>
        </div>
        
        <div class="card">
            <div class="card-body text-center">
                <h6>æƒ³è¦åˆ†ææ‚¨è‡ªå·±çš„å¤¢å¢ƒå—ï¼Ÿ</h6>
                <p class="text-muted mb-2">ä½¿ç”¨æˆ‘å€‘çš„ AI å¤¢å¢ƒåˆ†æç³»çµ±ï¼Œå‰µå»ºå°ˆå±¬æ–¼æ‚¨çš„å¤¢å¢ƒæ•…äº‹å’Œè¦–è¦ºåŒ–åœ–åƒã€‚</p>
                <a href="/" class="btn btn-outline-primary">
                    <i class="bi bi-cloud-moon"></i> é–‹å§‹åˆ†ææˆ‘çš„å¤¢å¢ƒ
                </a>
            </div>
        </div>
    </div>
</div>

<script>
function shareCurrentPage() {
    if (navigator.share) {
        navigator.share({
            title: 'å¤¢å¢ƒåˆ†æçµæœ',
            text: 'çœ‹çœ‹é€™å€‹æœ‰è¶£çš„å¤¢å¢ƒåˆ†æçµæœï¼',
            url: window.location.href
        });
    } else {
        // å‚™ç”¨æ–¹æ¡ˆï¼šè¤‡è£½åˆ°å‰ªè²¼æ¿
        navigator.clipboard.writeText(window.location.href).then(function() {
            alert('é€£çµå·²è¤‡è£½åˆ°å‰ªè²¼æ¿ï¼');
        }, function() {
            // å¦‚æœéƒ½ä¸æ”¯æ´ï¼Œå°±é¡¯ç¤ºé€£çµ
            prompt('è«‹è¤‡è£½é€™å€‹é€£çµä¾†åˆ†äº«ï¼š', window.location.href);
        });
    }
}
</script>
{% endblock %}